<h2 style="display: inline-block;">Synced Image Details</h2>

<button class="button" onclick="runSync('<%= Web.routes.path(:directorySync) %>')">Run Sync</button>
<!-- <button class="button" onclick="syncDirectories()">Run Sync</button> -->




<% if directories.any? %>
    <h3>Directories</h3>
    <% directories.each do |directory| %>
        <div class="directory-row">
            <p>
                <strong>Name:</strong> <%= directory.name %> <br>
                <strong>Path:</strong> <%= directory.path %> <br>
                <strong>Status:</strong> <%= directory.status %> <br>
                <strong>Count:</strong> <%= directory.imageCount %> <br>
            </p>
            <button class="button" onclick="runSync('<%= Web.routes.path(:directorySyncImages, id: directory.id) %>')">Resync</button>
            <button class="button button-danger" href="" onclick="removeDirectory('<%= Web.routes.path(:directoryRemove, id: directory.id) %>')">Remove</button>
        </div>
        <hr>
    <% end %>
<% end %>




<% if images.any? %>
    <p>Synced image count: <%= images.count %></p>
    <p>Images taken this day in history: <%= today.count %></p>

    <% if directories.any? %>
        <h3>Directories</h3>
        <% directories.each do |directory| %>
            <div class="directory-row">
                <p>
                    <strong>Path:</strong> <%= directory.path %> <br>
                </p>
                <button class="button" onclick="runSync('<%= Web.routes.path(:directorySyncImages, id: directory.id) %>')">Resync</button>
                <button class="button button-danger" href="" onclick="removeDirectory('<%= Web.routes.path(:directoryRemove, id: directory.id) %>')">Remove</button>
            </div>
            <hr>
        <% end %>
    <% end %>

    <h3>How to Get an Image</h3>
    <p>
        To get an image from today in history and default to any day if none were taken today in history, go to <a href="<%= Web.routes.path(:todayOrRandom) %>"><%= Web.routes.url(:todayOrRandom) %></a>
    </p>

    <h4>Options</h4>
    <table>
        <thead>
            <th>Option</th>
            <th>Syntax</th>
        </thead>
        <tbody>
            <tr>
                <td>resize</td>
                <td>size=960x540</td>
            </tr>
            <tr>
                <td>grayscale</td>
                <td>color=gray or mode=gray</td>
            </tr>
            <tr>
                <td>format</td>
                <td>format=png</td>
            </tr>
            <tr>
                <td>include date</td>
                <td>date=true</td>
            </tr>
        </tbody>
    </table>

    <p>
        Get random image and resize to 960x540 in grayscale with the date taken: <a href="<%= Web.routes.path(:todayOrRandom) %>?size=960x540&color=gray&date=true"><%= Web.routes.url(:todayOrRandom) %>?size=960x540&color=gray&date=true</a>
    </p>

    <% if today.any? %>
        <h3>Paths and Counts for Photos Taken Today</h3>

        <%
        path = nil
        count = 0
        today.each do |img|
            pathWithoutFileName = img.path.reverse.partition("/").last.reverse.partition('assets/').last
            if path != pathWithoutFileName
                if !path.nil? %>
                    <p>
                        <strong>Path:</strong> <%= path %> <br>
                        <strong>Count:</strong> <%= count %>
                    </p>
                    <hr>
                <% end
                path = pathWithoutFileName
                count = 0
            end
            count += 1
        end
        if !path.nil? %>
            <p>
                <strong>Path:</strong> <%= path %> <br>
                <strong>Count:</strong> <%= count %>
            </p>
        <% end
    end %>
<% else %>
    <p class="placeholder">There are no images synced yet.</p>
<% end %>
